\chapter{Einführung}

\label{cha_introduction}

%- Innentäter

Liest man von erfolgreichen Angriffen auf Unternehmensnetzwerke, so ist die implizite Annahme von externen, unternehmensfremden Angreifern weit verbreitet. Doch häufig sind die Angreifer bereits im Unternehmensnetzwerk selbst ansässig. Es handelt sich um (ehemalige) Mitarbeiter oder Personen mit legitimem Zugriff auf das Netzwerk, wie Geschäftspartnern oder Kunden. Hierbei spricht man von Insider-Angriffen, die ganz unterschiedlich ausfallen können:
\begin{itemize}
  \item Mitarbeiter, die die Kundendatenbank des Unternehmens kopieren, um diese als Einstellungsgrund für den nächsten Arbeitgeber zu nutzen;
  \item Mitarbeiter, die aus Verärgerung über ihre bevorstehende Kündigung Projekte durch Datenlöschung sabotieren;
  \item Mitarbeiter, die einem Konkurrenten Details über das Angebot der eigenen Firma zu einer Ausschreibung liefern, an der der Konkurrent ebenfalls Interesse besitzt;
  \item ...
\end{itemize}\todo{Im Fließtext?}
Bei dieser Art von Angriffen handelt es sich keineswegs nur um zu vernachlässigende Einzelfälle:
In dem \textit{IBM Cyber Security Intelligence Report} von 2015 werden 55 \% der Angriffe als aus dem internen Netz stammend angegeben \cite{ibm2015}.\footnote{
  Zu beachten ist allerdings, dass nicht nur mit Absicht ausgeführte Angriffe hierunter erfasst wurden, sondern auch unbeabsichtigte wie das versehentliche Veröffentlichen schützenswerter Kundendaten.
}
Auch der Branchenverband bitkom führt in seiner \textit{Spezialstudie Wirtschaftsschutz} aus dem Jahr 2016 nach einer Befragung von über 1000 Unternehmen aus, dass etwa 60\% der erfolgten Handlungen aus den Bereichen Datendiebstahl, Industriespionage oder Sabotage durch (ehemalige) Mitarbeiter erfolgten \cite{bitkom2016}.

Auch wenn die genauen Zahlen aufgrund von unterschiedlichen Annahmen und der in diesem Bereich nicht zu vernachlässigenden Dunkelziffer mit Vorsicht zu betrachten sind,\footnote{
	Insbesondere die Angst vor Imageschäden, die auch in der \textit{Spezialstudie Wirtschaftsschutz} erwähnt wird, könnte ein Grund für das Geheimhalten von Vorfällen sein.
} so geben sie doch Hinweise darauf, dass Angriffe von Innentätern weit verbreitet sind und ein hohes Schadenspotenzial aufweisen können. Die Erkennung und Verhinderung solcher Angriffe sollte daher ein wichtiger Teil des IT-Sicherheitskonzepts eines Unternehmens sein.

%- Lösung: Anomalieerkennung (zB QRadar, etc.)

Geht es darum, Insider-Angriffe zu erkennen oder zu verhindern, so sind viele bestehende Lösungen im Netzwerksicherheitsbereich nicht geeignet. Verbreitete Zugriffskontrollmechanismen, Firewalllösungen oder Intrusion-Detection/Prevention-Systeme konzentrieren sich oftmals lediglich auf die Erkennung oder Verhinderung externer Angriffe. Angriffe, die von legitimen Benutzern eines Netzwerks ausgeführt werden, wobei sie erlaubte Handlungen tätigen, sind jedoch auf diese Weise oftmals nicht adäquat zu behandeln.

Ein Ansatz, der diese Art von Angriffen entdecken kann, ist die sogenannte Anomalieerkennung. Dabei werden statistische Verfahren oder Verfahren aus dem Bereich des maschinellen Lernens benutzt, um Verhalten eines Nutzers, das vom erwarteten Verhalten abweicht, zu erkennen. 
  %Lösungen dieser Art sind beispielsweise in den SIEM-Systemen splunk oder IBM QRadar enthalten.
Für diese Verfahren werden allerdings umfangreiche Daten über die Tätigkeiten und das Verhalten von Mitarbeitern benötigt.

%- Überwachungsskandale, Datenschutzgrundlagen

Die Erhebung, Speicherung und Verarbeitung dieser Daten greift jedoch stark in das Recht auf informationelle Selbstbestimmung der Mitarbeiter ein. Aus den erfassten Daten können sich vielfältige Informationen über einen Arbeitnehmer gewinnen lassen: Beispielsweise können Daten aus elektronischen Türschlössern Bewegungsprofile ermöglichen oder Metadaten elektronischer Kommunikation Rückschlüsse auf persönliche Beziehungen erlauben.\\
Im Jahr 2017 wurde durch das Bundesarbeitsgericht ein Urteil gefällt, das die pauschale Überwachung der Rechnertätigkeit von Mitarbeitern verbietet.\footnote{
  BAG Erfurt, Az: 2 AZR 681/16.
} Nach Bundesdatenschutzgesetz ist das Verwenden personenbezogener Daten für die Aufdeckung von Straftaten erst bei gegebenem Anfangsverdacht erlaubt. Hierauf bezogen sich die Richter des Bundesarbeitsgerichts in ihrem Urteil. Geklagt hatte ein Arbeitnehmer, dem aufgrund von privater Nutzung eines dienstlichen Computers gekündigt wurde. Sein Arbeitgeber hatte die Nutzung durch einen Keylogger überwacht. 

%- Schwerpunkt: Speicherung nicht Anomalieerkennung
%- Ansatz
%- Warum Schwellwertschema

Es gilt also, den Bedarf nach Überwachungsdaten zum Zweck der Anomalieerkennung dem Recht auf informationelle Selbstbestimmung des Arbeitnehmers gegenüberzustellen. 
Ein Ansatz, der diesen Konflikt beheben kann, ist die Entfernung des direkten Pesonenbezugs der Daten durch die Verwendung von Pseudonymen. Die Anomalieerkennung kann mit den pseudonymisierten Daten normal arbeiten und im Fall des Verdachts auf einen erfolgten Angriff anstelle von Überwachungsdaten, die Mitarbeiternamen im Klartext enthalten, nun pseudonymisierte Daten ausgeben. % Dieses Vorgehen wurde bereits in einigen Forschungsarbeiten eingesetzt...
Nachdem die Anomalie überprüft wurde und ein Insider-Angriff für wahrscheinlich gehalten wird, muss der Halter des Pseudonyms aufgedeckt werden. Die Nutzung eines kryptographischen Schwellwertschemas kann diese Aufdeckung vor Missbrauch durch Einzelne technisch schützen.\\
Das Schwellwertschema ermöglicht die Aufdeckung eines Pseudonyms erst durch Kooperation mehrerer Beteiligter -- denkbar wären beispielsweise je nach Unternehmensform und -größe Personen der Arbeitgeberseite, der Datenschutzbeauftragte oder Mitglieder des Betriebsrats, so dass die Interessen aller Beteiligten gewahrt werden können. Hierbei spricht man auch vom Mehraugenprinzip. Auf der anderen Seite verhindert ein Schwellwertschema auch die Blockadehaltung Einzelner, da für die Aufdeckung nicht alle Beteiligten zustimmen müssen, sondern nur ein im Vorwege bestimmter Anteil.

In dieser Arbeit soll ein System entworfen und prototypisch implementiert werden, das diese Art der datenschutzfreundlichen Speicherung umsetzt.\footnote{
  Die Betrachtung der anschließend auf den gespeicherten Daten ausführbaren Anomalieerkennung wird in dieser Arbeit nicht behandelt. 
} Hierfür sind detaillierte Betrachtungen der beteiligten Komponenten und ihres Zusammenspiels notwendig. Die Umsetzung soll auf Basis eines Security-Information-Event-Management-Systems (SIEM-System) geschehen. Hierbei handelt es sich um Systeme, die dem Sammeln und der Analyse von Ereignissen in Netzwerken dienen, die insbesondere Sicherheitsaspekte betreffen.

%- Aufbau der Arbeit
Diese Arbeit ist dabei wie folgt aufgebaut:
In Kapitel \ref{cha_basics} werden Grundlagen für die in dieser Arbeit verwendeten Verfahren dargestellt.  
Kapitel \ref{cha_overview} stellt das zu entwickelnde System auf einer abstrakten Ebene dar. Es werden Anforderungen an ein solches System herausgearbeitet und darauf basierend eine verfahrensunabhängige Architektur entwickelt.
Die zu verwendenden Verfahren werden in Kapitel \ref{cha_state} betrachtet, dabei werden mögliche Alternativen dargestellt und bewertet sowie Entscheidungen für den umzusetzenden Prototyp getroffen.
Das anschließende \ref{cha_implementation}. Kapitel befasst sich mit der Implementation des Prototyp und seiner Evaluation. 
In Kapitel \ref{cha_alternatives} werden ergänzende Datenschutztechniken und ihre Integration in den Prototyp betrachtet.

\section*{Related work}
\label{related_work}

%\cite{salem2008survey}, A Survey of Insider Attack Detection Research, 2008, 195
%Übersicht über verschiedene Arten der Insider-Erkennung (Host-based and network-based), 
%we also believe that any technologies developed to detect insider attack have to include strong privacy-preserving guarantees,
%How might a system alert a supervisor of a possible attack without disclosing
%an employee’s true identity unless and until an attack has been validated?

Im Bereich der Erkennung von Insiderangriffen fand bereits einige Forschungsarbeit statt. In \cite{salem2008survey} bieten die Autoren einen Überblick über Forschungsergebnisse basierend auf unterschiedlichen Verfahren aus der Statistik und aus dem Bereich des maschinellen Lernens sowohl auf Host- als auch auf Netzwerkebene. Hier wird auch die Frage nach Erhalt der Privatsphäre eines Nutzers als Feld weiterer notwendiger Forschung dargestellt:

\begin{quotation}
\glqq Hence, we also believe that any technologies developed
to detect insider attack have to include strong privacy-preserving guarantees
to avoid making false claims that could harm the reputation of individuals
whenever errors occur. [...] 
How might a system alert a supervisor of a possible attack without disclosing
an employee’s true identity unless and until an attack has been validated?\grqq{}
\cite{salem2008survey}
\end{quotation}

%\cite{sobirey1997pseudonymous}, Pseudonymous Audit for Privacy Enhanced Intrusion Detection, 1997, 64
%Zwei Ansätze zur pseudonymen Intrusion Detection (IDA, AID), basieren auf symmetrischer Verschlüsselung (Erwähnung von 4-Augen-Prinzip durch Teilung des Schlüssels), Pseudonymisierung geschieht jeweils bereits im Betriebssystem-Kernel

%\cite{buschkes1999privacy}, Privacy enhanced intrusion detection, 1999, 23
%Architekturansatz unter Pseudonymnutzung, benötigt TTP für die Generierung und Aufdeckung von Pseudonymen, praktische Umsetzung mithilfe von Kerberos oder MIXen

%\cite{lundin1999privacy, lundin2000anomaly}, Privacy vs. Intrusion Detection Analysis, 1999, 35
%Anomalieerkennung unter Nutzung von Pseudonymisierung, Experimente mit Firewalldaten, Pseudonymaufdeckung als durch organisatorische Maßnahmen zu regelnder Prozess

%\cite{biskup2000threshold, biskup2001pseudonymization} On pseudonymization of audit data for intrusion detection, Threshold-based identity recovery for privacy enhanced applications, 2000, 44
%Pseudonymisierungsansatz, der Shares (Shamir's Secret Sharing) als Pseudonyme nutzt. Bei Überschreitung eines Schwellwerts kann so ein Verursacher, der in genug Verdachtsfällen auffiel, ermittelt werden.

Mit dieser Fragestellung beschäftigen sich weitere Veröffentlichungen im Bereich der Intrusion-Detection-Systeme. Oftmals wird -- wie in dieser Arbeit auch -- Pseudonymisierung als Verfahren zum Erhalt der Privatsphäre genutzt.\\
In \cite{sobirey1997pseudonymous} werden zwei Ansätze zur \textit{Privacy Enhanced Intrusion Detection} vorgestellt. Die Pseudonymisierung wird jeweils bereits im Betriebssystem-Kernel vorgenommen und mithilfe symmetrischer Verschlüsselung erreicht. Auch die Nutzung des Mehraugenprinzips wird bei der Pseudonymaufdeckung bereits erwähnt. Die Autoren nennen hierzu die Aufteilung des symmetrischen Schlüssels auf mehrere Parteien als Ansatz.\\
In \cite{buschkes1999privacy} stellt der Autor einen Architekturansatz für Intrusion-Detection-Systeme vor, der ebenfalls auf der Nutzung von Pseudonymen beruht. Es werden zwei Ansätze basierend auf Kerberos-Tickets bzw. auf dem Mix-Konzept vorgestellt. Für die Generierung bzw. Aufdeckung eines Pseudonyms wird eine \textit{Trusted Third Party} benötigt.\\
In \cite{lundin2000anomaly} wird von den Autoren ein System zur Anomalieerkennung auf Basis von Pseudonymen entwickelt und anhand von Logdaten einer Firewall überprüft. Das Aufdecken von Pseudonymen wird hier als durch organisatorische Maßnahmen zu regelnder Prozess verstanden.\\
In \cite{biskup2000threshold} und \cite{biskup2001pseudonymization} nutzen die Verfasser Shamir's Secret Sharing zur Erzeugung von Pseudonymen. Jeder Share bildet ein Pseudonym. Hierdurch wird sichergestellt, dass ein Pseudonym erst aufgedeckt werden kann, wenn eine einen Schwellwert übertreffende Anzahl von Warnmeldungen zu einem Nutzer im System eingetroffen ist.


%\cite{park2007ppids}, PPIDS : Privacy Preserving Intrusion Detection System, 2007, 7
%Rule-based pattern matching auf HIDS unter Nutzung von homomorpher Verschlüsselung ohne TTP, nur für bestimmte Situationen und relativ hoher Performanzoverhead

%\cite{niksefat2013zids}, ZIDS: A Privacy-Preserving Intrusion Detection System Using Secure Two-Party Computation Protocols, 2013, 11
%Client-Server Lösung zur Privacy-Preserving Intrusion Detection mit Geheimhaltungsgarantien für Clients (im Bezug auf zur Erkennung notwendige Daten) und Server (im Bezug auf Signaturen von Zero-Day-Exploits)

Neben den Pseudonym-basierten Lösungen gibt es weitere auf anderen Verfahren basierende Forschungsergebnisse zur datenschutzgerechten Erkennung von Angriffen. In \cite{park2007ppids} beispielsweise werden von den Autoren die Eigenschaften homomorpher Verschlüsselung zur privatsphäreerhaltenden Angriffserkennung eingesetzt. \cite{niksefat2013zids} verwendet eine Art der Mehrparteienberechnung, um mehrseitigen Datenschutz insbesondere im Hinblick auf Zero-Day-Lücken in einem Intrusion-Detection-System zu garantieren.

In \cite{niksefat2017privacy} bieten die Autoren einen Überblick über weitere existierende Lösungen im Bereich der \textit{Privacy Enhanced Intrusion Detection}.

%\cite{niksefat2017privacy}, Privacy issues in intrusion detection systems: A taxonomy, survey and future directions, 2017, 0
%Survey über existierende Lösungen im Bereich der Privacy preserving intrusion detection, für Kapitel Alternative Datenschutztechniken auch Übersicht über Privacy preserving techniques in IDS.









\endinput

%
% ALTES AUS DEM EXPOSE
%


% Drei-Projekt erwähnen? Oder nur allgemeine Informationen entnehmen?

%- Insiderangriffe 

%- SIEM-Systeme in aktueller Form keine adäquate Lösung

%- Datenschutzrecht Arbeitnehmer

%- Mögliche Lösung: Pseudonymisierung und Schwellwertschemata mit verteilten Schlüsseln

%- Spannungsfeld Aufdeckbarkeit und Datenschutz

\todo{
Wo passen Abschnitte zu folgenden Stichworten hin?
- Verschiedene Datenarten: Identifizierend, Traffic, nicht relevant, ...
- Grundlegende Definition Insiderangriff
}

Liest man von erfolgreichen Angriffen auf Unternehmensnetzwerke, so ist die implizite Annahme von außenstehenden, unternehmensfremden Angreifern weit verbreitet. Doch häufig sind die Angreifer bereits im Netzwerk ansässig. Es handelt sich um (ehemalige) Mitarbeiter oder Personen mit legitimem Zugriff auf das Netzwerk, wie Geschäftspartnern oder Kunden. 

Hierbei handelt es sich keineswegs um Einzelfälle:
In dem \textit{IBM Cyber Security Intelligence Report} von 2015 werden 55\% der Angriffe als aus dem internen Netz stammend angegeben \cite{ibm2015}\footnote{
  Zu beachten ist allerdings, dass nicht nur mit Absicht ausgeführte Angriffe hierunter erfasst wurden, sondern auch unbeabsichtigte wie das versehentliche Veröffentlichen schützenswerter Kundendaten.
}.
Auch der Branchenverband bitkom führt in seiner \textit{Spezialstudie Wirtschaftsschutz} aus dem Jahr 2016 nach einer Befragung von über 1000 Unternehmen aus, dass etwa 60\% der erfolgten Handlungen aus dem Bereich Datendiebstahl, Industriespionage oder Sabotage durch (ehemalige) Mitarbeiter erfolgten \cite{bitkom2016}.

\todo{Schadenshöhe (siehe Antrag)?}

Auch wenn die genauen Zahlen aufgrund von unterschiedlichen Annahmen und der in diesem Bereich nicht zu vernachlässigenden Dunkelziffer\footnote{
	Insbesondere die Angst vor Imageschäden, die auch in der \textit{Spezialstudie Wirtschaftsschutz} erwähnt wird, könnte ein Grund für das Geheimhalten von Vorfällen sein.
} mit Vorsicht zu betrachten sind, so geben sie doch Hinweise darauf, dass Angriffe von Innentätern weit verbreitet sind und ein hohes Schadenspotenzial aufweisen. Die Erkennung und Verhinderung solcher Angriffe sollte daher ein wichtiger Teil des IT-Sicherheitskonzepts eines Unternehmens sein.

Zur Erkennung von Angriffen in Netzwerken können SIEM-Systeme eingesetzt werden (siehe Abschnitt \ref{cha_siem}). Diese sind jedoch in erster Linie auf das Erkennen von externen Angriffen ausgelegt und in ihrer derzeitigen Form kaum sinnvoll für das Erkennen von Innentätern zu nutzen. \todo{EZ: Warum nicht? Einige werben damit, Innentaeter erkennen zu koennen, z.B. IBM QRadar} \\
Hierfür würden zusätzliche Datenquellen und Erkennungslogiken nötig sein.\todo{EZ: Warum? Welche?} 
Zusätzlich spielen auch  datenschutzrechtliche Bedenken im Bezug auf das Sammeln von großen Datenmengen über Mitarbeiter des eigenen Unternehmens hier eine entscheidende Rolle. Details hierzu sind im folgenden Kapitel \ref{cha_employee_privacy} zu finden.

Ein Ansatz, der diese Bedenken ausräumen oder zumindest lindern könnte, ist die Nutzung von Pseudonymen bei der Datenerfassung (siehe Abschnitt \ref{cha_pseudonym}). Anstatt direkt identifizierende Merkmale eines Arbeitnehmers abzuspeichern, werden diese Merkmale durch ein Pseudonym ersetzt. Eine Liste dieser Ersetzungen wird verschlüsselt abgelegt. Im Fall eines Angriffs durch einen Innentäter kann die Liste entschlüsselt werden und relevante Ereignisse de-pseudonymisiert, also ihrem ursprünglichen Verursacher wieder zweifelsfrei zugeordnet, werden.\\
Um die Entschlüsselung nicht einzelnen (möglicherweise bösartig agierenden) Personen zu ermöglichen, können sogenannte Schwellwertschemata eingesetzt werden (siehe Abschnitt \ref{cha_threshold}). Durch sie wird die Entschlüsselung erst durch die Kooperation mehrerer Parteien möglich gemacht.

Bei diesem Ansatz muss jedoch auch beachtet werden, dass durch den Einsatz von Pseudonymen die Erkennung von Angriffen erschwert werden könnte. Beispielsweise könnte das Ändern von Pseudonymen in regelmäßigen Zeitintervallen und die dadurch entstehende Nicht-Verkettbarkeit von Ereignissen dafür sorgen, dass langfristig angelegte Angriffe nicht aufgedeckt werden.

\section*{Ziele der Arbeit}

%- OSSIM: wo ansetzen? Agent, Client, dazwischen (eigene Komponente) Performancemessungen

%- Schlüsselmanagement (Clientseitig erzeugen, wie verteilen, etc.)

%- Welche kryptographischen Schwellwertschemata? Performancemessungen

%- Welche Funktionen? (Reine Verschlüsselung, Pseudonymisierung mit Mappingtabelle, ... -> erweiterbar)


In dieser Arbeit soll es darum gehen, prototypisch ein solches Szenario auf Basis eines Open-Source-SIEM-Systems umzusetzen.\todo{EZ: Was genau ist das Szenario? Liegt dein Fokus nun auf den zusaetzlichen Datenquellen und Erkennungslogiken oder auf den datenschutzrechtlichen Bedenken?} 
Hierbei müssen einige Fragen betrachtet werden:

\begin{itemize}
\item An welcher Stelle des Systems kann eingegriffen werden, um die erfassten Daten zu verändern, und welche Auswirkungen hat dies?
\item Wie erfolgt die angesprochene Pseudonymisierung technisch?
\item Welche kryptographischen Schwellwertschemata können genutzt werden? Gibt es bereits quelloffene Implementierungen? Was muss selbst entwickelt werden? Wie erfolgt das Schlüsselmanagement?
\item Können neben der Pseudonymisierung noch weitere Funktionen zur Veränderung von Daten sinnvoll sein und wie könnten diese umgesetzt werden?
\end{itemize}

Gerade die letzte Frage sorgt dafür, dass zusätzliche Anforderungen an den zu entwickelnden Prototypen gestellt werden. Es sollte möglich sein, abhängig von den eingehenden Daten die entsprechend gewünschten Funktionen konfigurieren und den Prototypen in eventuell aufbauenden Arbeiten auch um zusätzliche Funktionen ergänzen zu können.
